const screen = document.getElementById("screen")
const readBtn = document.getElementById("read-btn")
const pauseBtn = document.getElementById("pause-btn")
const characterBoxLeft = document.getElementById("character-box-left")
const characterBoxRight = document.getElementById("character-box-right")
const textBox = document.getElementById("text-box")
const storyText = document.getElementById("story-text")
const contiText = document.getElementById("conti-text")
const readbook_container = document.getElementById("readbook-container")
const book_text = document.getElementById("book-text")
const choices = document.getElementById("choices")
const choiceBtn1 = document.getElementById("choice-1")
const choiceBtn2 = document.getElementById("choice-2")
const background = document.getElementById("background")
const allTextBox = document.getElementById("alltext-box")
const allText = document.getElementById("all-text")
const exitTextBtn = document.getElementById("exit-text-btn")

const pauseMenu = document.getElementById("pause-menu")
const resumeBtn = document.getElementById("resume-btn")
const restartBtn = document.getElementById("restart-btn")
const mainBtn = document.getElementById("main-btn")

const loadingScreen = document.getElementById("load-image");
const preloadPercent = document.getElementById("preload-percent");
const preloadBar = document.getElementById("preload-bar");

const mapBtn = document.getElementById("map-btn");
const mapFrame = document.getElementById("map-frame");
const mapContainer = document.getElementById("scene-block");
const closeMapBtn = document.getElementById("close-map-btn");

let sceneHistory = [];
let gameVariables = {};
let currentScene = "scene_1";
let activeSaveSlot = null;
let autoSaveTimer = null;

let typeInterval = null;
let all_text = "";
let isTyping = false;
let advanceLock = false;
let hasFinishedTyping = false;

let story = {}
const API_URL = "https://illusia-backend.onrender.com";
async function loadStoryFromBackend() {
    try {
        const res = await fetch("https://illusia-backend.onrender.com/story");
        const data = await res.json();

        // à¹à¸›à¸¥à¸‡ array à¸ˆà¸²à¸ DB â†’ object à¹à¸šà¸š story[scene_id] = {...}
        data.forEach(scene => {
            story[scene.scene_id] = {
                text: scene.text,
                background: scene.background,
                character: scene.character,
                characterleft: scene.character_left,
                characterright: scene.character_right,
                delay: scene.delay,
                diarytext: scene.diarytext,
                choice1: scene.choice1_text,
                choice1_next: scene.choice1_next,
                choice2: scene.choice2_text,
                choice2_next: scene.choice2_next,
                choice_position_top1: scene.choice_position_top1,
                choice_position_left1: scene.choice_position_left1,
                choice_position_top2: scene.choice_position_top2,
                choice_position_left2: scene.choice_position_left2,
                next: scene.next
            };
        });

        console.log("âœ… Story loaded:", story);
    } catch (err) {
        console.error("âŒ Failed to load story:", err);
    }
}

// const story = {
//     scene_1: {
//         text: "\â€œà¹à¸®à¹ˆà¸â€” à¹à¸®à¹ˆà¸ ..\â€ \nà¹€à¸«à¸‡à¸·à¹ˆà¸­à¸Šà¸·à¹‰à¸™à¹„à¸«à¸¥à¸‹à¸¶à¸¡à¸•à¸±à¹‰à¸‡à¹à¸•à¹ˆà¹„à¸£à¸œà¸¡ à¸¥à¸²à¸à¸œà¹ˆà¸²à¸™à¸—à¸´à¹‰à¸‡à¸«à¸¢à¸²à¸”à¸«à¸¢à¸”à¸ˆà¸²à¸à¸›à¸¥à¸²à¸¢à¸„à¸²à¸‡ à¸£à¹ˆà¸²à¸‡à¸à¸²à¸¢à¸•à¸·à¹ˆà¸™à¸•à¸±à¸§à¸ªà¸¸à¸”à¸‚à¸µà¸”â€” à¸­à¸°à¸”à¸£à¸µà¸™à¸²à¸¥à¸µà¸™à¸žà¹ˆà¸¸à¸‡à¸žà¸¥à¹ˆà¸²à¸™à¸Šà¹ˆà¸§à¸¢à¹€à¸£à¹ˆà¸‡à¸à¸µà¹€à¸—à¹‰à¸²à¸™à¸±à¹‰à¸™à¹ƒà¸«à¹‰à¸à¹‰à¸²à¸§à¸¢à¸²à¸§à¸‚à¸¶à¹‰à¸™ ...",
//         background : "../picture/background_story/scene_1.jpg", 
//         next: "delay_scene_1_2"
//     },
//     delay_scene_1_2: {
//         background : "../picture/background_story/delay_scene_1_2.jpg",
//         next: "delay_scene_1_3",
//         delay: 500
//     },
//     delay_scene_1_3: {
//         background : "../picture/background_story/delay_scene_1_3.jpg",
//         next: "delay_scene_1_4",
//         delay: 500
//     },
//     delay_scene_1_4 : {
//         background : "../picture/background_story/delay_scene_1_4.jpg",
//         next: "delay_scene_1_5",
//         delay: 500
//     },
//     delay_scene_1_5 : {
//         background : "../picture/background_story/delay_scene_1_5.jpg",
//         next: "scene_2",
//         delay: 500
//     },
//     scene_2: {
//         text: "â€˜ à¸•à¸¸à¸šâ€” â€™\nà¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸•à¸£à¸‡à¸«à¸™à¹‰à¸²à¸žà¸¥à¸±à¸™à¸”à¸±à¸šà¸¡à¸·à¸” à¸›à¸£à¸°à¸ªà¸²à¸—à¸ªà¸±à¸¡à¸œà¸±à¸ªà¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸–à¸¹à¸à¸•à¸±à¸”à¸‚à¸²à¸” à¸ªà¸£à¸£à¸žà¸²à¸‡à¸„à¹Œà¸à¸²à¸¢à¸ªà¸±à¹ˆà¸™à¸ªà¸°à¸—à¹‰à¸²à¸™ à¸¡à¸µà¹€à¸žà¸µà¸¢à¸‡à¸¥à¸¡à¸«à¸²à¸¢à¹ƒà¸ˆà¸ªà¸°à¸”à¸¸à¸”à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™à¸—à¸µà¹ˆà¸„à¸­à¸¢à¸¢à¹‰à¸³à¹€à¸•à¸·à¸­à¸™à¸§à¹ˆà¸²à¸¢à¸±à¸‡à¸¡à¸µà¸Šà¸µà¸§à¸´à¸•à¸­à¸¢à¸¹à¹ˆ",
//         background : "../picture/background_story/scene_2.jpg",
//         next: "scene_3", 
//     },

//     scene_3: {
//         text: "\â€œ à¹€à¸®à¸·à¸­à¸â€”! \â€",
//         background : "../picture/background_story/scene_3.jpg",
//         next: "scene_3_1"
//     },

//     scene_3_1: {
//         text: "à¹€à¸›à¸¥à¸·à¸­à¸à¸•à¸²à¹€à¸›à¸´à¸”à¸‚à¸¶à¹‰à¸™à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡ à¹€à¸žà¸”à¸²à¸™à¸ªà¸µà¸‚à¸²à¸§à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸„à¸£à¸£à¸¥à¸­à¸‡ à¹à¸œà¹ˆà¸™à¸«à¸¥à¸±à¸‡à¹à¸™à¸šà¹„à¸›à¸à¸±à¸šà¸œà¸´à¸§à¸ªà¸±à¸¡à¸œà¸±à¸ªà¸™à¸¸à¹ˆà¸¡à¸‚à¸­à¸‡à¹€à¸•à¸µà¸¢à¸‡ à¸¡à¸·à¸­à¸«à¸™à¸¶à¹ˆà¸‡à¸¢à¸±à¸‡à¸à¸³à¹€à¸ªà¸·à¹‰à¸­à¸•à¸±à¸§à¹€à¸­à¸‡à¹à¸™à¹ˆà¸™à¸ˆà¸™à¹à¸—à¸šà¸ˆà¸°à¸à¸²à¸à¸£à¸­à¸¢à¸à¸±à¸‡à¸¥à¸‡à¸šà¸™à¸­à¸â€” à¸ªà¸±à¸šà¸ªà¸™ à¹€à¸£à¸·à¹ˆà¸­à¸‡à¸à¹ˆà¸­à¸™à¸«à¸™à¹‰à¸²à¸£à¸²à¸§à¸„à¸§à¸²à¸¡à¸à¸±à¸™à¸«à¸¥à¸­à¸à¸«à¸¥à¸­à¸™ à¸ªà¸²à¸¢à¸•à¸²à¸à¸§à¸²à¸”à¸¡à¸­à¸‡ à¸„à¸§à¸²à¸¡à¸—à¸£à¸‡à¸ˆà¸³à¹„à¸¡à¹ˆà¸ªà¸¡à¹€à¸«à¸•à¸¸à¸ªà¸¡à¸œà¸¥à¹à¸¥à¸°à¹€à¸¥à¸·à¸­à¸™à¸£à¸²à¸‡ à¸ˆà¸¶à¸‡à¸„à¹ˆà¸­à¸¢ à¹† à¸«à¸¢à¸±à¸”à¸à¸²à¸¢à¸¥à¸¸à¸à¹€à¸Šà¸·à¹ˆà¸­à¸‡à¸Šà¹‰à¸² ...",
//         background : "../picture/background_story/scene_3.jpg",
//         next: "scene_3_2"
//     },

//     scene_3_2: {
//         text: "\â€œ à¹€à¸¡à¸·à¹ˆà¸­à¸à¸µà¹‰à¸¡à¸±à¸™- à¸­à¸°à¹„à¸£à¸™à¹ˆà¸° ...\nà¸à¸±à¸™à¸£à¹‰à¸²à¸¢à¹€à¸«à¸£à¸­ .. \â€",
//         background : "../picture/background_story/startroom.jpg",
//         characterleft: "../picture/Character/Character01.png",
//         delay_characterleft : 450,
//         next: "scene_4"
//     },

//     scene_4: {
//         text: "à¸ à¸²à¸žà¸•à¸£à¸‡à¸«à¸™à¹‰à¸²à¸„à¸·à¸­à¸«à¹‰à¸­à¸‡à¸™à¸­à¸™à¹ƒà¸«à¸à¹ˆ à¸ªà¸²à¸¢à¸•à¸²à¸à¸§à¸²à¸”à¸¡à¸­à¸‡à¹„à¸›à¸£à¸­à¸š à¹† à¸žà¸¥à¸²à¸‡à¹€à¸£à¸µà¸¢à¸šà¹€à¸£à¸µà¸¢à¸‡à¹€à¸£à¸·à¹ˆà¸­à¸‡à¸£à¸²à¸§à¹ƒà¸™à¸«à¸±à¸§ à¸„à¸§à¸²à¸¡à¸„à¸¸à¹‰à¸™à¹€à¸„à¸¢à¹à¸—à¸£à¸à¹€à¸‚à¹‰à¸²à¸¡à¸²à¸—à¸µà¸¥à¸°à¸™à¹‰à¸­à¸¢à¸—à¸³à¹ƒà¸«à¹‰à¸¡à¸±à¹ˆà¸™à¹ƒà¸ˆà¸¡à¸²à¸à¸à¸§à¹ˆà¸²à¸«à¹‰à¸²à¸ªà¹ˆà¸§à¸™â€” à¹„à¸¡à¹ˆà¸œà¸´à¸”à¹à¸™à¹ˆ à¸™à¸µà¹ˆà¸„à¸·à¸­à¸«à¹‰à¸­à¸‡à¸™à¸­à¸™à¸‚à¸­à¸‡à¸šà¸´à¸”à¸²à¸¡à¸²à¸£à¸”à¸², à¸«à¹‰à¸­à¸‡à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸¡à¸µà¹ƒà¸„à¸£à¹„à¸”à¹‰à¸£à¸±à¸šà¸­à¸™à¸¸à¸à¸²à¸•à¹ƒà¸«à¹‰à¸–à¸·à¸­à¸„à¸£à¸­à¸‡à¸à¸¸à¸à¹à¸ˆ à¸«à¹‰à¸­à¸‡à¸—à¸µà¹ˆà¸à¸£à¸°à¸—à¸±à¹ˆà¸‡à¸¥à¸¹à¸à¸Šà¸²à¸¢à¹€à¸Šà¹ˆà¸™à¸•à¸™à¸¢à¸±à¸‡à¸•à¹‰à¸­à¸‡à¹à¸­à¸šà¸›à¸¥à¸”à¸à¸¥à¸­à¸™à¹€à¸‚à¹‰à¸²à¸¡à¸²à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸‡à¸µà¸¢à¸šà¹€à¸Šà¸µà¸¢à¸š à¸ªà¸§à¸™à¸¥à¸±à¸šà¸‚à¸­à¸‡à¸žà¸§à¸à¸—à¹ˆà¸²à¸™ ...",
//         background : "../picture/background_story/startroom.jpg",
//         next: "scene_5"
//     },

//     scene_5: {
//         text: "\â€œ à¸™à¸µà¹ˆà¸‰à¸±à¸™... à¹€à¸”à¸´à¸™à¸¥à¸°à¹€à¸¡à¸­à¸«à¸£à¸·à¸­à¸¢à¸±à¸‡à¹„à¸‡à¸à¸±à¸™ \â€\nâ€˜ à¹€à¸Šà¹ˆà¸™à¸™à¸±à¹‰à¸™à¹à¸¥à¹‰à¸§à¸šà¸´à¸”à¸²à¸¡à¸²à¸£à¸”à¸²à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™ à¹„à¸‰à¸™à¹€à¸¥à¸¢à¸•à¸™à¸ˆà¸¶à¸‡à¸™à¸­à¸™à¸šà¸™à¸«à¸¡à¸­à¸™à¸™à¸¸à¹ˆà¸¡à¹„à¸”à¹‰à¸ªà¸šà¸²à¸¢à¹ƒà¸ˆà¹€à¸‰à¸´à¸šâ€” â€™",
//         background : "../picture/background_story/startroom.jpg",
//         characterleft: "../picture/Character/Character02.png",
//         delay_characterleft : 450,
//         next: "scene_6"
//     },

//     scene_6: {
//         text: "à¹€à¸¡à¸·à¹ˆà¸­à¸—à¸­à¸”à¸¡à¸­à¸‡à¸œà¹ˆà¸²à¸™à¸šà¸²à¸™à¸«à¸™à¹‰à¸²à¸•à¹ˆà¸²à¸‡ à¹à¸ªà¸‡à¸ˆà¸±à¸™à¸—à¸£à¹Œà¸—à¸­à¸œà¹ˆà¸²à¸™à¸šà¸­à¸à¹ƒà¸«à¹‰à¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸£à¸²à¸•à¸£à¸µà¸¥à¹ˆà¸§à¸‡à¹€à¸¥à¸¢à¸¡à¸²à¸„à¸£à¸¶à¹ˆà¸‡à¸„à¹ˆà¸­à¸™à¸„à¸·à¸™à¹à¸¥à¹‰à¸§ à¸„à¸§à¸²à¸¡à¸—à¸£à¸‡à¸ˆà¸³à¸à¸¥à¸±à¸šà¸„à¸¥à¹‰à¸²à¸¢à¹„à¸£à¹‰à¸›à¸£à¸°à¹‚à¸¢à¸Šà¸™à¹Œ à¸«à¸™à¸³à¸‹à¹‰à¸³à¸¢à¸±à¸‡à¸—à¸§à¸µà¸„à¸¹à¸“à¸„à¸§à¸²à¸¡à¹€à¸„à¸¥à¸·à¸­à¸šà¹à¸„à¸¥à¸‡ à¸ªà¸±à¸à¸Šà¸²à¸•à¸à¸²à¸“à¸à¸¹à¹ˆà¸£à¹‰à¸­à¸‡à¸§à¹ˆà¸²à¸šà¸²à¸‡à¸­à¸¢à¹ˆà¸²à¸‡à¹ƒà¸™à¸™à¸µà¹‰à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ à¹€à¸¡à¸·à¹ˆà¸­à¹ƒà¸™à¸¡à¸·à¸­à¸•à¸™à¹„à¸£à¹‰à¸­à¸¸à¸›à¸à¸£à¸“à¹Œà¸—à¸µà¹ˆà¸ˆà¸°à¸›à¸¥à¸”à¸à¸¥à¸­à¸™à¸›à¸£à¸°à¸•à¸¹à¹€à¸ªà¸µà¸¢à¸”à¹‰à¸§à¸¢à¸‹à¹‰à¸³ ...",
//         background : "../picture/background_story/startroom.jpg",
//         choice1: {text : "à¸ªà¸³à¸£à¸§à¸ˆ",next : "explore_1"},
//         choice2: {text : "à¹„à¸¡à¹ˆà¸ªà¸³à¸£à¸§à¸ˆ",next : "scare_1"},
//         choice_position_top1: "35%",
//         choice_position_left1: "50%%",
//         choice_position_top2: "55%",
//         choice_position_left2: "50%"
//     },

//     explore_1: {
//         text: "à¸„à¸§à¸²à¸¡à¸ªà¸‡à¸ªà¸±à¸¢à¹€à¸‚à¹‰à¸²à¹€à¸à¸²à¸°à¸à¸¸à¸¡ à¸ˆà¸¶à¸‡à¹€à¸¥à¸·à¸­à¸à¸—à¸µà¹ˆà¸ˆà¸°à¹„à¸‚à¸§à¹ˆà¸„à¸§à¹‰à¸²à¸«à¸²à¸„à¸³à¸•à¸­à¸šâ€” à¸à¸£à¸°à¸—à¸³à¸à¸²à¸£à¸•à¸²à¸¡à¹ƒà¸ˆà¸•à¸™à¹€à¸­à¸‡à¹€à¸Šà¹ˆà¸™à¹„à¸¡à¹ˆà¸à¸¥à¸±à¸§à¸§à¹ˆà¸²à¸ˆà¸°à¸–à¸¹à¸à¸¥à¸‡à¹‚à¸—à¸© à¸‚à¸²à¸à¹‰à¸²à¸§à¸¥à¸‡à¸ˆà¸²à¸à¹€à¸•à¸µà¸¢à¸‡ à¹„à¸¥à¹ˆà¸ªà¸²à¸¢à¸•à¸²à¸ªà¸³à¸£à¸§à¸ˆà¸—à¸±à¹‰à¸‡à¸™à¸´à¹‰à¸§à¸¡à¸·à¸­à¸ˆà¸±à¸šà¸•à¹‰à¸­à¸‡ à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹ƒà¸à¸¥à¹‰à¹€à¸„à¸µà¸¢à¸‡à¸„à¸§à¸²à¸¡ â€˜ à¸›à¸à¸•à¸´ â€™ à¸«à¸²à¸à¸ªà¸¡à¸¸à¸”à¹€à¸¥à¹ˆà¸¡à¸«à¸™à¸¶à¹ˆà¸‡à¸—à¸µà¹ˆà¸§à¸²à¸‡à¹€à¸”à¹ˆà¸™à¸šà¸™à¹‚à¸•à¹Šà¸°à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸”à¸¶à¸‡à¸”à¸¹à¸”à¹ƒà¸«à¹‰à¸œà¸´à¸™à¹ƒà¸šà¸«à¸™à¹‰à¸²à¸¡à¸­à¸‡à¹€à¸ªà¸µà¸¢à¸à¹ˆà¸­à¸™",
//         background : "../picture/background_story/explore/explore_1.jpg",
//         next: "explore_2"
//     },

//     explore_2: {
//         text: "à¸¡à¸±à¸™à¹€à¸›à¸·à¹‰à¸­à¸™à¸£à¸­à¸¢à¸„à¸£à¸²à¸šà¹à¸«à¹‰à¸‡à¸à¸£à¸±à¸‡à¸ªà¸µà¹€à¸‚à¹‰à¸¡ à¹€à¸¡à¸·à¹ˆà¸­à¸¥à¸²à¸à¸›à¸¥à¸²à¸¢à¸™à¸´à¹‰à¸§à¸¥à¸¹à¸šà¸œà¹ˆà¸²à¸™à¸¢à¸´à¹ˆà¸‡à¸«à¸¢à¸²à¸šà¹€à¸¢à¹‡à¸™ à¸žà¸¥à¸±à¸™à¸™à¸¶à¸à¸–à¸¶à¸‡à¸„à¸§à¸²à¸¡à¸ªà¸à¸›à¸£à¸à¸¢à¸´à¹ˆà¸‡à¸žà¸²à¸¥à¹ƒà¸«à¹‰à¸‚à¸¢à¸°à¹à¸‚à¸¢à¸‡ à¸à¹ˆà¸²à¸¡à¸·à¸­à¸«à¸¢à¸´à¸šà¸¡à¸±à¸™à¸‚à¸¶à¹‰à¸™à¸¡à¸²à¸žà¸¥à¸´à¸à¸”à¸¹à¸Šà¹‰à¸² à¹† à¸«à¸™à¹‰à¸²à¸›à¸à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸šà¹ˆà¸‡à¸šà¸­à¸à¸–à¸¶à¸‡à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡ à¸«à¸²à¸à¸­à¸™à¸¸à¸¡à¸²à¸™à¹€à¸­à¸²à¸ˆà¸²à¸à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸—à¸µà¹ˆà¸¡à¸±à¸™à¸­à¸¢à¸¹à¹ˆ à¹€à¸Šà¹ˆà¸™à¸™à¸±à¹‰à¸™à¸­à¸²à¸ˆà¹€à¸›à¹‡à¸™à¸‚à¸­à¸‡à¸«à¸™à¸¶à¹ˆà¸‡à¹ƒà¸™à¸šà¸¸à¸žà¸à¸²à¸£à¸µ",
//         background : "../picture/background_story/explore/explore_2.jpg",
//         next: "explore_3"
//     },

//     explore_3: {
//         text: "à¹ƒà¸„à¸£à¹ˆà¸£à¸¹à¹‰à¹€à¸ªà¸µà¸¢à¹€à¸•à¹‡à¸¡à¸›à¸£à¸°à¸”à¸² à¸žà¸¥à¸´à¸à¹€à¸›à¸´à¸”à¸¡à¸±à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸Šà¸·à¹ˆà¸­à¸‡à¸Šà¹‰à¸² à¸­à¸²à¸¨à¸±à¸¢à¹à¸ªà¸‡à¸ˆà¸±à¸™à¸—à¸£à¹Œà¸•à¹ˆà¸²à¸‡à¹‚à¸„à¸¡à¹„à¸Ÿ à¸ªà¹ˆà¸§à¸™à¸«à¸™à¸¶à¹ˆà¸‡à¹ƒà¸™à¹€à¸šà¸·à¹‰à¸­à¸‡à¸¥à¸¶à¸à¸¢à¸±à¸‡à¹€à¸à¸£à¸‡à¸à¸¥à¸±à¸§ à¸«à¸²à¸à¹à¸•à¸°à¹‚à¸”à¸™à¸„à¸§à¸²à¸¡à¸¥à¸±à¸šà¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸¡à¸µà¹ƒà¸„à¸£à¸£à¸±à¸šà¸£à¸¹à¹‰à¹€à¸‚à¹‰à¸² à¹€à¸Šà¹ˆà¸™à¸™à¸±à¹‰à¸™à¸•à¸™à¸ˆà¸°à¹à¸ªà¸”à¸‡à¸ªà¸µà¸«à¸™à¹‰à¸²à¹à¸šà¸šà¹„à¸«à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸•à¹‰à¸­à¸‡à¸žà¸šà¹€à¸ˆà¸­à¸à¸±à¸™â€” à¸—à¸§à¹ˆà¸²à¸„à¸§à¸²à¸¡à¸ˆà¸£à¸´à¸‡à¸à¸¥à¸±à¸šà¹„à¸¡à¹ˆà¹€à¸›à¹‡à¸™à¹€à¸Šà¹ˆà¸™à¸™à¸±à¹‰à¸™ à¸¥à¸²à¸¢à¸¡à¸·à¸­à¸—à¸µà¹ˆà¸‚à¸µà¸”à¹€à¸‚à¸µà¸¢à¸™à¸”à¸¹à¸„à¸¸à¹‰à¸™à¸•à¸²à¹€à¸à¸´à¸™à¸à¸§à¹ˆà¸²à¸ˆà¸°à¹€à¸›à¹‡à¸™à¸‚à¸­à¸‡à¹ƒà¸„à¸£à¸­à¸·à¹ˆà¸™ à¸¢à¸´à¹ˆà¸‡à¹„à¸¥à¹ˆà¸™à¸´à¹‰à¸§à¸­à¹ˆà¸²à¸™à¹„à¸›à¹ƒà¸™à¹à¸•à¹ˆà¸¥à¸°à¸šà¸£à¸£à¸—à¸±à¸” à¸—à¸±à¹‰à¸‡à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸² à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸›à¸°à¸•à¸´à¸”à¸›à¸°à¸•à¹ˆà¸­ à¹à¸¥à¸°à¸ à¸²à¸žà¸ à¸²à¸žà¸«à¸™à¸¶à¹ˆà¸‡ à¸¢à¸´à¹ˆà¸‡à¸„à¸¥à¹‰à¸²à¸¢à¸§à¹ˆà¸²à¸¡à¸±à¸™à¸ˆà¸°à¸Šà¸µà¹‰à¹€à¸‚à¹‰à¸²à¸¡à¸²à¸«à¸²à¸•à¸™ ...",
//         background : "../picture/background_story/explore/explore_3.jpg",
//         next: "explore_3_diary"
//     },

//     explore_3_diary: {
//         diarytext: "à¹’à¹— à¸à¸±à¸™à¸¢à¸²à¸¢à¸™\nà¸¥à¹ˆà¸§à¸‡à¹€à¸¥à¸¢à¹€à¸‚à¹‰à¸²à¸¤à¸”à¸¹à¸à¸™à¹à¸¥à¹‰à¸§ à¸¥à¸±à¹ˆà¸™à¸—à¸¡à¸œà¸¥à¸´à¸”à¸­à¸à¹ƒà¸šà¸šà¸²à¸™à¸—à¹ˆà¸²à¸¡à¸à¸¥à¸²à¸‡à¸žà¸²à¸¢à¸¸à¹‚à¸«à¸¡à¸à¸£à¸°à¸«à¸™à¹ˆà¸³\nà¸‰à¸±à¸™à¸¡à¸­à¸‡à¹€à¸˜à¸­à¸—à¸µà¹ˆà¸™à¸±à¹ˆà¸‡à¸­à¸¢à¸¹à¹ˆà¸‚à¹‰à¸²à¸‡à¸šà¸²à¸™à¸«à¸™à¹‰à¸²à¸•à¹ˆà¸²à¸‡ à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¸­à¸²à¸ˆà¸£à¸¹à¹‰à¹„à¸”à¹‰à¹€à¸¥à¸¢à¸§à¹ˆà¸²à¹€à¸˜à¸­à¸„à¸´à¸”à¸­à¸°à¹„à¸£à¸­à¸¢à¸¹à¹ˆ \nà¹€à¸˜à¸­à¸”à¸¹à¹à¸›à¸¥à¸à¹„à¸› ..\nà¹ƒà¸™à¸¤à¸”à¸¹à¸—à¸µà¹ˆà¹€à¸˜à¸­à¹‚à¸›à¸£à¸”à¸›à¸£à¸²à¸™\nà¸à¸¥à¸±à¸šà¸„à¸¥à¹‰à¸²à¸¢à¸§à¹ˆà¸²à¹€à¸˜à¸­à¹‚à¸­à¸šà¸à¸­à¸”à¸„à¸§à¸²à¸¡à¹‚à¸¨à¸à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹„à¸§à¹‰à¹ƒà¸™à¸—à¸£à¸§à¸‡\n\nà¹˜ à¸•à¸¸à¸¥à¸²à¸„à¸¡\nà¹€à¸˜à¸­à¸ˆà¸±à¸”à¹€à¸•à¸£à¸µà¸¢à¸¡à¸ªà¸³à¸£à¸±à¸šà¸­à¸²à¸«à¸²à¸£à¹€à¸Šà¹ˆà¸™à¸›à¸à¸•à¸´ à¸‰à¸±à¸™à¹à¸­à¸šà¸Šà¹ˆà¸§à¸¢à¹€à¸«à¸¥à¸·à¸­à¹€à¸˜à¸­à¸­à¸¢à¸¹à¹ˆà¸«à¹ˆà¸²à¸‡ à¹† \nà¸à¹ˆà¸­à¸™à¸ˆà¸°à¸–à¸¹à¸à¹€à¸£à¸µà¸¢à¸à¸•à¸±à¸§à¹„à¸›à¸—à¸µà¹ˆà¸­à¸·à¹ˆà¸™ ... \nà¹€à¸¢à¹‡à¸™à¸§à¸±à¸™à¸™à¸±à¹‰à¸™à¸‰à¸±à¸™à¸à¸¥à¸±à¸šà¸¡à¸²à¹€à¸žà¸·à¹ˆà¸­à¸žà¸šà¸§à¹ˆà¸²à¹€à¸˜à¸­à¸¡à¸µà¸šà¸²à¸”à¹à¸œà¸¥ à¸¡à¸±à¸™à¸–à¸¹à¸à¸žà¸±à¸™à¸—à¸±à¸šà¸”à¹‰à¸§à¸¢à¸œà¹‰à¸²à¸‚à¸²à¸§ \nà¸ˆà¸²à¸à¸„à¸³à¸šà¸­à¸à¹€à¸¥à¹ˆà¸²à¸™à¸±à¹‰à¸™à¸šà¸­à¸à¸§à¹ˆà¸²à¹€à¸˜à¸­à¹€à¸«à¸¡à¹ˆà¸­à¸¥à¸­à¸¢à¸ˆà¸™à¹€à¸œà¸¥à¸­à¸—à¸³à¸„à¸¡à¸¡à¸µà¸”à¸šà¸²à¸”à¸•à¸±à¸§à¹€à¸­à¸‡ \nà¸‰à¸±à¸™à¸›à¸¥à¸­à¸šà¹€à¸˜à¸­ à¸žà¸¢à¸²à¸¢à¸²à¸¡à¹€à¸­à¸²à¸•à¸±à¸§à¸šà¸±à¸‡à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¹€à¸˜à¸­à¸–à¸¹à¸à¸”à¸¸à¹„à¸›à¸¡à¸²à¸à¸à¸§à¹ˆà¸²à¸™à¸µà¹‰\n\nà¹’à¹ à¸•à¸¸à¸¥à¸²à¸„à¸¡\nà¸§à¸±à¸™à¸™à¸µà¹‰à¸à¸™à¸•à¸à¸«à¸™à¸±à¸à¸à¸§à¹ˆà¸²à¹€à¸„à¸¢ à¹€à¸˜à¸­à¹€à¸à¹‡à¸šà¸•à¸±à¸§à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸«à¹‰à¸­à¸‡à¸ˆà¸™à¸¥à¹ˆà¸§à¸‡à¹€à¸¥à¸¢à¸–à¸¶à¸‡à¸¢à¸²à¸¡à¹€à¸¢à¹‡à¸™ à¸¡à¸·à¹‰à¸­à¸­à¸²à¸«à¸²à¸£à¹„à¸¡à¹ˆà¸–à¸¹à¸à¹à¸•à¸°à¸•à¹‰à¸­à¸‡ \nà¹€à¸˜à¸­à¹€à¸­à¹ˆà¸¢à¸šà¸­à¸à¸‰à¸±à¸™à¹€à¸ªà¸µà¸¢à¸‡à¹€à¸šà¸²à¸«à¸§à¸´à¸§à¸§à¹ˆà¸²à¹€à¸˜à¸­à¹„à¸¡à¹ˆà¸„à¹ˆà¸­à¸¢à¸ªà¸šà¸²à¸¢à¹€à¸—à¹ˆà¸²à¹ƒà¸”à¸™à¸±à¸ .. \nà¸‰à¸±à¸™à¹€à¸›à¹‡à¸™à¸«à¹ˆà¸§à¸‡ à¸ˆà¸¶à¸‡à¸•à¸±à¸§à¸•à¸´à¸”à¹€à¸˜à¸­à¹„à¸¡à¹ˆà¸«à¹ˆà¸²à¸‡ à¸ˆà¸™à¸ªà¹ˆà¸‡à¹€à¸˜à¸­à¹€à¸‚à¹‰à¸²à¸™à¸­à¸™à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡ \n\nà¹‘ à¸žà¸¤à¸¨à¸ˆà¸´à¸à¸²à¸¢à¸™\nà¸œà¸·à¸™à¸™à¸ à¸²à¹à¸ˆà¹ˆà¸¡à¹ƒà¸ªà¸«à¸¥à¸±à¸‡à¸à¸™à¸„à¸¥à¹‰à¸­à¸¢à¸«à¸²à¸¢ à¹€à¸˜à¸­à¸Šà¸§à¸™à¸‰à¸±à¸™à¸­à¸­à¸à¹„à¸›à¹€à¸”à¸´à¸™à¹€à¸¥à¹ˆà¸™ \nà¹€à¸£à¸²à¸‹à¸·à¹‰à¸­à¸‚à¸™à¸¡à¸—à¸µà¹ˆà¹€à¸˜à¸­à¸Šà¸­à¸š à¸¢à¸·à¸™à¸¡à¸­à¸‡à¸¥à¸±à¹ˆà¸™à¸—à¸¡à¸£à¸´à¸¡à¸—à¸²à¸‡à¸—à¸µà¹ˆà¸œà¸¥à¸´à¹ƒà¸šà¹ƒà¸«à¸¡à¹ˆ \nà¹€à¸ªà¸µà¸¢à¸‡à¸«à¸±à¸§à¹€à¸£à¸²à¸°à¹à¸¥à¸°à¸£à¸­à¸¢à¸¢à¸´à¹‰à¸¡à¹€à¸˜à¸­à¸ªà¸°à¸—à¹‰à¸­à¸™à¹ƒà¸™à¸™à¸±à¸¢à¸™à¹Œà¸•à¸²à¸‰à¸±à¸™ .. \nà¸™à¸²à¸™à¹à¸„à¹ˆà¹„à¸«à¸™à¹à¸¥à¹‰à¸§à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹€à¸«à¹‡à¸™à¸„à¸§à¸²à¸¡à¸ªà¸§à¹ˆà¸²à¸‡à¹„à¸ªà¸§à¸ˆà¸²à¸à¹€à¸˜à¸­à¹€à¸Šà¹ˆà¸™à¸™à¸µà¹‰ \nà¸‰à¸±à¸™à¸­à¸¢à¸²à¸à¹ƒà¸«à¹‰à¸¡à¸±à¸™à¸„à¸‡à¸­à¸¢à¸¹à¹ˆà¸•à¸¥à¸­à¸”à¹„à¸› ...\n\nà¹‘à¹“ à¸žà¸¤à¸¨à¸ˆà¸´à¸à¸²à¸¢à¸™\nà¹€à¸˜à¸­ ... (à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸­à¹ˆà¸²à¸™à¹„à¸”à¹‰) à¹à¸¥à¹‰à¸§ .. à¹ƒà¸™à¸«à¹‰à¸­à¸‡à¸‚à¸­à¸‡à¹€à¸˜à¸­ \nà¹ƒà¸šà¸«à¸™à¹‰à¸²à¹€à¸˜à¸­à¸”à¸¹à¸¡à¸µà¸„à¸§à¸²à¸¡à¸ªà¸¸à¸‚à¸¡à¸²à¸à¸à¸§à¹ˆà¸²à¸—à¸¸à¸à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²à¸—à¸µà¹ˆà¸œà¹ˆà¸²à¸™à¸¡à¸²à¹€à¸ªà¸µà¸¢à¸­à¸µà¸\n\nà¸«à¸²à¸à¸‰à¸±à¸™à¹„à¸¡à¹ˆà¸—à¸´à¹‰à¸‡à¹€à¸˜à¸­à¹„à¸§à¹‰ ...",
//         background : "../picture/background_story/explore/explore_3.jpg",
//         next: "explore_4"
//     },

//     explore_4: {
//         text: "à¹à¸•à¹ˆà¸à¸¥à¸±à¸šà¹„à¸£à¹‰à¸‹à¸¶à¹ˆà¸‡à¸„à¸§à¸²à¸¡à¸—à¸£à¸‡à¸ˆà¸³ à¸Šà¹ˆà¸§à¸‡à¹€à¸§à¸¥à¸²à¸•à¸­à¸™à¸™à¸µà¹‰à¸™à¸±à¸šà¹€à¸›à¹‡à¸™à¹€à¸—à¹ˆà¸²à¹ƒà¸”à¸ˆà¸²à¸à¸šà¸±à¸™à¸—à¸¶à¸ à¸«à¸£à¸·à¸­à¹€à¸›à¹‡à¸™à¹à¸„à¹ˆà¹€à¸£à¸·à¹ˆà¸­à¸‡à¸£à¸²à¸§à¹€à¸žà¹‰à¸­à¸à¸±à¸™à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¹ƒà¸™à¸ˆà¸´à¸™à¸•à¸™à¸²à¸à¸²à¸£â€” à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¹à¸¥à¸°à¹„à¸¡à¹ˆà¹€à¸‚à¹‰à¸²à¹ƒà¸ˆ à¹à¸œà¹ˆà¸™à¸«à¸¥à¸±à¸‡à¹€à¸«à¸¢à¸µà¸¢à¸”à¸•à¸£à¸‡ à¸›à¸£à¸°à¸•à¸¹à¸«à¹‰à¸­à¸‡à¸­à¸¢à¸¹à¹ˆà¹„à¸¡à¹ˆà¹„à¸à¸¥à¹€à¸à¸´à¸™à¸ªà¸´à¸šà¸à¹‰à¸²à¸§ à¹€à¸Šà¹ˆà¸™à¸™à¸±à¹‰à¸™à¸„à¸·à¸™à¸™à¸µà¹‰à¸„à¸§à¸£à¸à¸¥à¸±à¸šà¹„à¸›à¸žà¸±à¸à¸œà¹ˆà¸­à¸™à¸à¹ˆà¸­à¸™à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ",
//         background : "../picture/background_story/explore/explore_4.jpg",
//         next: "explore_5"
//     },

//     explore_5: {
//         text: "à¹€à¸¡à¸·à¹ˆà¸­à¸à¹‰à¸²à¸§à¸­à¸­à¸à¸¡à¸² à¸—à¸²à¸‡à¹€à¸”à¸´à¸™à¸•à¸£à¸‡à¸«à¸™à¹‰à¸²à¸¢à¸±à¸‡à¸„à¸‡à¹€à¸›à¹‡à¸™à¹€à¸Šà¹ˆà¸™à¹€à¸”à¸´à¸¡ à¸«à¹‰à¸­à¸‡à¸‚à¸­à¸‡à¸•à¸™à¸­à¸¢à¸¹à¹ˆà¸ªà¸¸à¸”à¸›à¸¥à¸²à¸¢à¸—à¸²à¸‡ à¸”à¹‰à¸²à¸™à¸‚à¹‰à¸²à¸‡à¸„à¸·à¸­à¸šà¸±à¸™à¹„à¸”à¹„à¸›à¸ªà¸¹à¹ˆà¸Šà¸±à¹‰à¸™à¸¥à¹ˆà¸²à¸‡ à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸™à¸±à¹‰à¸™à¸¡à¸±à¸™à¸–à¸¹à¸à¸„à¸±à¹ˆà¸™à¸”à¹‰à¸§à¸¢à¸«à¹‰à¸­à¸‡à¸™à¸­à¸™à¸‚à¸­à¸‡à¸­à¸µà¸à¸«à¸™à¸¶à¹ˆà¸‡à¸šà¸¸à¸•à¸£à¸µà¸œà¸¹à¹‰à¸¡à¸µà¸¨à¸±à¸à¸”à¸´à¹Œà¹€à¸›à¹‡à¸™à¸žà¸µà¹ˆà¸ªà¸²à¸§ ...",
//         background : "../picture/background_story/explore/explore_5.jpg",
//         next: "explore_6"
//     },

//     explore_6: {
//         text: "â€˜ à¸”à¸¶à¸à¸”à¸·à¹ˆà¸™à¹€à¸Šà¹ˆà¸™à¸™à¸µà¹‰à¹€à¸˜à¸­à¸ˆà¸°à¸«à¸¥à¸±à¸šà¹„à¸›à¸«à¸£à¸·à¸­à¸¢à¸±à¸‡ .. â€™",
//         background : "../picture/background_story/explore/explore_6.jpg",
//         characterleft: "../picture/Character/Character03.png",
//         delay_characterleft : 450,
//         next: "explore_7"
//     },

//     explore_7: {
//         text: "à¸­à¸²à¸ˆà¹€à¸žà¸£à¸²à¸°à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸ªà¸šà¸²à¸¢à¹ƒà¸ˆà¸ˆà¸²à¸à¸ªà¸¡à¸¸à¸”à¹€à¸¥à¹ˆà¸¡à¸™à¸±à¹‰à¸™ à¸«à¸£à¸·à¸­à¸­à¸²à¸ˆà¹€à¸žà¸µà¸¢à¸‡à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸„à¸§à¸²à¸¡à¸­à¸šà¸­à¸¸à¹ˆà¸™à¹€à¸«à¸¡à¸·à¸­à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¸—à¸µà¹ˆà¹€à¸„à¸¢ à¸ˆà¸¶à¸‡à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¹€à¸”à¸´à¸™à¸•à¸£à¸‡à¹„à¸›à¸¢à¸±à¸‡à¸«à¸™à¹‰à¸²à¸›à¸£à¸°à¸•à¸¹ à¸«à¸¥à¸±à¸‡à¸¡à¸·à¸­à¹€à¸„à¸²à¸°à¸¥à¸‡à¹€à¸šà¸² à¹† à¸—à¸§à¹ˆà¸²à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¸¡à¸µà¹€à¸ªà¸µà¸¢à¸‡à¸•à¸­à¸šà¸£à¸±à¸š à¸à¹ˆà¸²à¸¡à¸·à¸­à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¹„à¸›à¸à¸³à¸£à¸­à¸šà¸¥à¸¹à¸à¸šà¸´à¸” à¸­à¸­à¸à¹à¸£à¸‡à¸«à¸¡à¸¸à¸™à¸¡à¸±à¸™à¹ƒà¸«à¹‰à¹€à¸›à¸´à¸”à¸­à¸­à¸",
//         background : "../picture/background_story/explore/explore_7.jpg",
//         next: "explore_8"
//     },

//     explore_8: {
//         text: "à¸¡à¸±à¸™à¸ªà¹ˆà¸‡à¹€à¸ªà¸µà¸¢à¸‡ â€˜ à¹à¸à¸£à¹Šà¸â€” â€™ à¹à¸•à¹ˆà¸à¸¥à¸±à¸šà¸›à¸´à¸”à¸ªà¸™à¸´à¸— à¸™à¸¶à¸à¸‰à¸‡à¸™ â€˜ à¹€à¸Šà¹ˆà¸™à¸™à¸±à¹‰à¸™à¸„à¸‡à¸«à¸¥à¸±à¸šà¹à¸¥à¹‰à¸§à¸à¸£à¸°à¸¡à¸±à¸‡, à¹‚à¸”à¸¢à¸›à¸à¸•à¸´à¹€à¸˜à¸­à¹€à¸›à¹‡à¸™à¸„à¸™à¹€à¸‚à¹‰à¸²à¸™à¸­à¸™à¹à¸•à¹ˆà¸«à¸±à¸§à¸„à¹ˆà¸³à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§ â€™ à¸—à¸­à¸”à¸–à¸­à¸™à¸«à¸²à¸¢à¹ƒà¸ˆ à¸žà¸¥à¸±à¸™à¹€à¸«à¸¥à¸·à¸­à¸šà¸¡à¸­à¸‡à¸¢à¸±à¸‡à¸«à¹‰à¸­à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡",
//         background : "../picture/background_story/explore/explore_8.jpg",
//         next: "explore_9"
//     },

//     explore_9: {
//         text: "à¸ˆà¸¸à¸”à¸«à¸¡à¸²à¸¢à¸„à¸·à¸­à¸ªà¸¸à¸”à¸—à¸²à¸‡à¹€à¸”à¸´à¸™ à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¸¥à¸”à¸¥à¸‡à¹€à¸£à¸·à¹ˆà¸­à¸¢ à¹† à¸à¸£à¸°à¸—à¸±à¹ˆà¸‡à¸«à¸¢à¸¸à¸”à¸à¸²à¸¢à¸¥à¸‡à¸«à¸™à¹‰à¸²à¸«à¹‰à¸­à¸‡à¸‚à¸­à¸‡à¸•à¸™ à¹ƒà¸™à¸‚à¸“à¸°à¸—à¸µà¹ˆà¸à¸³à¸¥à¸±à¸‡à¸ˆà¸°à¹€à¸›à¸´à¸”à¸›à¸£à¸°à¸•à¸¹à¸šà¸²à¸™à¸™à¸±à¹‰à¸™ à¹€à¸ªà¸µà¸¢à¸‡à¸à¸¸à¸à¸à¸±à¸à¸—à¸µà¹ˆà¸¥à¸­à¸”à¸œà¹ˆà¸²à¸™à¸—à¸³à¹ƒà¸«à¹‰à¸à¹ˆà¸²à¸¡à¸·à¸­à¸«à¸¢à¸¸à¸”à¸Šà¸°à¸‡à¸±à¸à¸à¸¥à¸²à¸‡à¸­à¸²à¸à¸²à¸¨ ...",
//         background : "../picture/background_story/explore/explore_9.jpg",
//         next: "explore_10"
//     },

//     explore_10: {
//         text: "à¹à¸œà¹ˆà¸™à¸«à¸¥à¸±à¸‡à¸¢à¸°à¹€à¸¢à¸·à¸­à¸ à¸„à¸§à¸²à¸¡à¸à¸¥à¸±à¸§à¸£à¸°à¸„à¸™à¸ªà¸‡à¸ªà¸±à¸¢à¹à¸—à¸£à¸à¸‹à¸¶à¸¡à¸œà¹ˆà¸²à¸™à¸œà¸´à¸§à¸«à¸™à¸±à¸‡ à¸«à¸²à¸‡à¸•à¸²à¸ªà¸šà¸à¸±à¸šà¸šà¸±à¸™à¹„à¸”à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸–à¸±à¸”à¹„à¸› à¸•à¸£à¸²à¸Šà¸±à¹ˆà¸‡à¸ à¸²à¸¢à¹ƒà¸™à¸ˆà¸´à¸•à¹ƒà¸ˆà¹€à¸­à¸™à¹€à¸­à¸µà¸¢à¸‡à¹„à¸¡à¹ˆà¸¡à¸±à¹ˆà¸™à¸„à¸‡ ..",
//         background : "../picture/background_story/explore/explore_10.jpg",
//         choice1: {text : "à¹€à¸›à¸´à¸”à¸›à¸£à¸°à¸•à¸¹à¸«à¹‰à¸­à¸‡à¸•à¸£à¸‡à¸«à¸™à¹‰à¸²",next : "explore_opendoor_1"},
//         choice2: {text : "à¸¥à¸‡à¹„à¸›à¸Šà¸±à¹‰à¸™à¸¥à¹ˆà¸²à¸‡",next : "explore_downstair_1"},
//         choice_position_top1: "",
//         choice_position_left1: "72%",
//         choice_position_top2: "60%",
//         choice_position_left2: "35%"
//     },

//     explore_opendoor_1: {
//         text: "à¸¥à¸¹à¸à¸šà¸´à¸”à¸„à¸¥à¹‰à¸²à¸¢à¸¡à¸§à¸¥à¸™à¹‰à¸³à¹à¸‚à¹‡à¸‡ à¹€à¸¡à¸·à¹ˆà¸­à¸›à¸¥à¸²à¸¢à¸™à¸´à¹‰à¸§à¹à¸•à¸°à¸žà¸²à¹ƒà¸«à¹‰à¸ªà¸°à¸”à¸¸à¹‰à¸‡à¸­à¸­à¸à¹ƒà¸™à¸„à¸£à¸²à¹à¸£à¸ à¸à¹ˆà¸­à¸™à¸à¸­à¸šà¸à¸¸à¸¡à¹à¸¥à¸°à¸«à¸¡à¸¸à¸™à¸¡à¸±à¸™à¹€à¸›à¸´à¸”à¸­à¸­à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸Šà¹‰à¸² à¹† à¸•à¸£à¸‡à¸à¸±à¸™à¸‚à¹‰à¸²à¸¡à¸à¸±à¸šà¹€à¸ªà¸µà¸¢à¸‡à¸”à¸±à¸‡à¸£à¸°à¸£à¸±à¸§à¸‚à¸­à¸‡à¸ˆà¸±à¸‡à¸«à¸§à¸°à¸Šà¸µà¸žà¸ˆà¸£",
//         background : "../picture/background_story/explore_opendoor_1.jpg",
//         next: "explore_opendoor_2"
//     },

//     explore_opendoor_2: {
//         text: "à¸šà¸²à¸™à¸›à¸£à¸°à¸•à¸¹à¹€à¸œà¸¢à¹ƒà¸«à¹‰à¹€à¸«à¹‡à¸™à¸«à¹‰à¸­à¸‡à¸”à¹‰à¸²à¸™à¹ƒà¸™ à¸¢à¸²à¸¡à¸£à¸²à¸•à¸£à¸µà¸—à¸µà¹ˆà¹à¸ªà¸‡à¸ˆà¸±à¸™à¸—à¸£à¹Œà¸ªà¸²à¸”à¸—à¸­ à¸¡à¸±à¸™à¸—à¸²à¸šà¸—à¸±à¸šà¸£à¹ˆà¸²à¸‡à¸«à¸à¸´à¸‡à¸ªà¸²à¸§à¹ƒà¸™à¸­à¸²à¸ à¸£à¸“à¹Œà¸ªà¸µà¸‚à¸²à¸§à¸™à¸§à¸¥ à¸£à¸±à¸šà¸à¸±à¸šà¹€à¸£à¸·à¸­à¸™à¸œà¸¡à¸”à¸±à¸‡à¸™à¸´à¸¥à¸à¸²à¸¬ à¹€à¸‡à¸²à¸œà¸µà¹€à¸ªà¸·à¹‰à¸­à¸£à¸²à¸¢à¸¥à¹‰à¸­à¸¡à¸”à¸­à¸¡à¸”à¸¡à¸œà¸à¸²à¸ªà¸µà¸Šà¸²à¸”â€” à¹€à¸˜à¸­à¸§à¸²à¸”à¸£à¸­à¸¢à¸¢à¸´à¹‰à¸¡à¹à¸¢à¹‰à¸¡à¹ƒà¸«à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸­à¹ˆà¸­à¸™à¹‚à¸¢à¸™ ...",
//         background : "../picture/background_story/explore_opendoor_2.jpg",
//         next: "to_be_continue"
//     },

//     explore_downstair_1: {
//         text: "à¸œà¸´à¸™à¹ƒà¸šà¸«à¸™à¹‰à¸²à¸¡à¸­à¸‡à¸¥à¸‡à¹„à¸›à¸¢à¸±à¸‡à¸Šà¸±à¹‰à¸™à¸¥à¹ˆà¸²à¸‡ à¸à¸²à¸£à¹„à¸¡à¹ˆà¸›à¸£à¸°à¹€à¸Šà¸´à¸à¸«à¸™à¹‰à¸²à¸­à¸²à¸ˆà¹€à¸›à¹‡à¸™à¸—à¸²à¸‡à¹€à¸¥à¸·à¸­à¸à¸—à¸µà¹ˆà¸”à¸µà¸à¸§à¹ˆà¸² à¹ƒà¸™à¸à¸£à¸“à¸µà¸—à¸µà¹ˆà¸•à¹‰à¸™à¸•à¸­à¹€à¸ªà¸µà¸¢à¸‡à¹ƒà¸™à¸™à¸±à¹‰à¸™à¹€à¸›à¹‡à¸™à¸ªà¸´à¹ˆà¸‡à¹„à¸¡à¹ˆà¸„à¸²à¸”à¸à¸±à¸™â€” à¸‚à¸²à¸à¹‰à¸²à¸§à¸¥à¸‡à¸ˆà¸²à¸à¸šà¸±à¸™à¹„à¸”à¸—à¸µà¸¥à¸°à¸‚à¸±à¹‰à¸™ .. à¸—à¸µà¸¥à¸°à¸‚à¸±à¹‰à¸™à¸ˆà¸™à¸žà¹‰à¸™ à¹€à¸«à¸¢à¸µà¸¢à¸šà¸¥à¸‡à¸šà¸™à¸žà¸·à¹‰à¸™ à¹à¸¡à¹‰à¸ªà¸²à¸¢à¸•à¸²à¸„à¸¸à¹‰à¸™à¸Šà¸´à¸™à¸à¸±à¸šà¸„à¸§à¸²à¸¡à¸¡à¸·à¸”à¹à¸•à¹ˆà¸à¸¥à¸±à¸šà¸¡à¸­à¸‡à¹€à¸«à¹‡à¸™à¹€à¸žà¸µà¸¢à¸‡à¹€à¸‡à¸²à¸¥à¸²à¸‡ à¹† à¸¡à¸·à¸­à¸¢à¸à¸¡à¸²à¸„à¸¥à¸³à¸—à¸²à¸‡à¹€à¸žà¸·à¹ˆà¸­à¸«à¸²à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡à¸•à¹ˆà¸­à¹„à¸› ...",
//         background : "../picture/background_story/downstair.jpg",
//         next: "to_be_continue"
//     },

//     scare_1: {
//         text: "â€˜ à¸«à¸²à¸à¸žà¸§à¸à¸—à¹ˆà¸²à¸™à¸£à¸¹à¹‰à¹€à¸‚à¹‰à¸²â€” à¹„à¸¡à¹ˆà¸žà¹‰à¸™à¸•à¹‰à¸­à¸‡à¹‚à¸”à¸™à¸”à¸¸à¹à¸™à¹ˆ .. â€™",
//         background : "../picture/background_story/startroom.jpg",
//         next: "scare_2"
//     },

//     scare_2: {
//         text: "à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸ªà¸­à¸™à¸§à¹ˆà¸²à¹„à¸¡à¹ˆà¸„à¸§à¸£à¹€à¸‚à¹‰à¸²à¸¡à¸²à¹€à¸¥à¹ˆà¸™à¹ƒà¸™à¸«à¹‰à¸­à¸‡à¸™à¸µà¹‰à¹„à¸¡à¹ˆà¸­à¸²à¸ˆà¸à¸±à¸‡à¸¥à¸¶à¸à¹„à¸”à¹‰à¹€à¸—à¹ˆà¸²à¸šà¸—à¸¥à¸‡à¹‚à¸—à¸©à¸—à¸µà¹ˆà¸£à¹ˆà¸²à¸‡à¸à¸²à¸¢à¸ˆà¸”à¸ˆà¸³ à¸¥à¸¡à¸«à¸²à¸¢à¹ƒà¸ˆà¸ªà¸¹à¸”à¸¥à¸¶à¸ à¸ªà¸²à¸¢à¸•à¸²à¹€à¸£à¸´à¹ˆà¸¡à¸„à¸¸à¹‰à¸™à¸Šà¸´à¸™à¸à¸±à¸šà¸„à¸§à¸²à¸¡à¸¡à¸·à¸” à¸žà¸¥à¸±à¸™à¸ªà¸±à¸‡à¹€à¸à¸•à¹€à¸«à¹‡à¸™à¹€à¸‡à¸²à¸”à¸³à¸•à¸£à¸‡à¸¡à¸¸à¸¡à¸«à¹‰à¸­à¸‡â€” à¸¢à¸´à¹ˆà¸‡à¹€à¸žà¹ˆà¸‡à¸„à¸§à¸²à¸¡à¸ªà¸™à¹ƒà¸ˆ â€˜ à¸¡à¸±à¸™ â€™ à¸¢à¸´à¹ˆà¸‡à¹à¸ªà¸¢à¸°à¸¢à¸´à¹‰à¸¡à¸¡à¸­à¸šà¹ƒà¸«à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¹ˆà¸²à¸ªà¸¢à¸”à¸ªà¸¢à¸­à¸‡",
//         background : "../picture/background_story/scare/scare_2.jpg",
//         next: "black1_scare_2"
//     },

//     black1_scare_2:{
//         background : "",
//         next: "ghostpop1_scare_2",
//         delay: 100
//     },

//     ghostpop1_scare_2: {
//         background : "../picture/background_story/scare/ghostpop1_scare_2.jpg",
//         next: "black2_scare_2",
//         delay: 750
//     },

//     black2_scare_2:{
//         background : "",
//         next: "ghostpop2_scare_2",
//         delay: 100
//     },

//     ghostpop2_scare_2: {
//         background : "../picture/background_story/scare/ghostpop2_scare_2.jpg",
//         next: "black3_scare_2",
//         delay: 750
//     },

//     black3_scare_2:{
//         background : "",
//         next: "ghostpop3_scare_2",
//         delay: 100
//     },

//     ghostpop3_scare_2: {
//         background : "../picture/background_story/scare/ghostpop3_scare_2.jpg",
//         next: "black3_scare_3",
//         delay: 750
//     },

//     black3_scare_3:{
//         background : "",
//         next: "scare_3",
//         delay: 100
//     },

//     scare_3: {
//         text: "à¸”à¸§à¸‡à¸•à¸²à¹€à¸šà¸´à¸à¹‚à¸žà¸¥à¸‡ à¸„à¸§à¸²à¸¡à¸à¸¥à¸±à¸§à¹€à¸ªà¸µà¸¢à¸”à¹à¸—à¸‡à¸¥à¸¶à¸à¸–à¸¶à¸‡à¸à¸£à¸°à¸”à¸¹à¸ à¸¥à¸¡à¸«à¸²à¸¢à¹ƒà¸ˆà¸ªà¸±à¹ˆà¸™à¸à¸£à¸°à¸Šà¸±à¹‰à¸™â€” â€˜ à¸¡à¸±à¸™ â€™ à¸¢à¸±à¸‡à¸„à¸‡à¸­à¸¢à¸¹à¹ˆà¸™à¸´à¹ˆà¸‡à¹€à¸Šà¹ˆà¸™à¸£à¸­à¸„à¸­à¸¢ à¸‰à¸µà¸à¸¢à¸´à¹‰à¸¡à¸à¸§à¹‰à¸²à¸‡, à¸›à¸¥à¸²à¸¢à¹€à¸—à¹‰à¸²à¸à¹‰à¸²à¸§à¸–à¸­à¸¢à¸­à¸¢à¹ˆà¸²à¸‡à¸£à¸°à¸§à¸±à¸‡ à¹ƒà¸™à¸‚à¸“à¸°à¸—à¸µà¹ˆà¸ªà¸²à¸¢à¸•à¸²à¸¢à¸±à¸‡à¸•à¸£à¸¶à¸‡à¹„à¸§à¹‰à¹„à¸¡à¹ˆà¸à¸°à¸žà¸£à¸´à¸š à¸£à¸²à¸§à¸«à¸²à¸à¹€à¸œà¸¥à¸­à¹„à¸›à¹€à¸žà¸µà¸¢à¸‡à¹€à¸ªà¸µà¹‰à¸¢à¸§à¸§à¸´à¸™à¸²à¸—à¸µ à¸¡à¸±à¸™à¸ˆà¸°à¸à¸£à¸°à¹‚à¸ˆà¸™à¹€à¸‚à¹‰à¸²à¸¡à¸²à¸‚à¸¢à¹‰à¸³à¸ˆà¸™à¹„à¸¡à¹ˆà¹€à¸«à¸¥à¸·à¸­à¸Šà¸´à¹‰à¸™à¸”à¸µ",
//         background : "../picture/background_story/scare/scare_2.jpg",
//         character: "../picture/Character/Character04.png",
//         delay_character : 450,
//         next: "scare_4",
//     },

//     scare_4: {
//         text: "à¹€à¸¡à¸·à¹ˆà¸­à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¸ˆà¸²à¸à¸›à¸£à¸°à¸•à¸¹à¸¥à¸”à¸¥à¸‡à¸¡à¸²à¸à¸žà¸­ à¸ªà¸­à¸‡à¸‚à¸²à¸žà¸¸à¹ˆà¸‡à¹„à¸›à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸¡à¹ˆà¸„à¸´à¸”à¸Šà¸µà¸§à¸´à¸• à¹à¸£à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹‚à¸–à¸¡à¹ƒà¸ªà¹ˆà¸¥à¸¹à¸à¸šà¸´à¸” à¸›à¸£à¸°à¸•à¸¹à¸à¸£à¸°à¹à¸—à¸à¹€à¸›à¸´à¸”à¹€à¸ªà¸µà¸¢à¸‡à¸”à¸±à¸‡à¸¥à¸±à¹ˆà¸™ à¸—à¸´à¹‰à¸‡à¸à¸²à¸¢à¸–à¸¥à¸²à¹„à¸›à¸à¸±à¸šà¸—à¸²à¸‡à¹€à¸”à¸´à¸™à¸”à¹‰à¸²à¸™à¸™à¸­à¸à¹ƒà¸™à¸„à¸£à¸²à¸§à¹€à¸”à¸µà¸¢à¸§ à¹€à¸ªà¸µà¸¢à¸‡ â€˜ à¸›à¸±à¸‡â€”! â€™ à¹„à¸¥à¹ˆà¸«à¸¥à¸±à¸‡à¸à¹‰à¸­à¸‡à¸ªà¸°à¸—à¹‰à¸­à¸™ à¸”à¸±à¸‡à¹à¸‚à¹ˆà¸‡à¸à¸±à¸šà¸Šà¸µà¸žà¸ˆà¸£à¸£à¸°à¸£à¸±à¸§à¹ƒà¸™à¸­à¸",
//         background : "../picture/background_story/scare/scare_2.jpg",
//         next: "scare_5"
//     },

//     scare_5: {
//         text: "à¸—à¸²à¸‡à¹€à¸”à¸´à¸™à¸—à¸­à¸”à¸¢à¸²à¸§à¹„à¸›à¸‚à¹‰à¸²à¸‡à¸«à¸™à¹‰à¸² à¹à¸ªà¸‡à¸•à¸à¸à¸£à¸°à¸—à¸šà¸ªà¸£à¹‰à¸²à¸‡à¹€à¸‡à¸²à¹ƒà¸«à¹‰à¸Šà¸§à¸™à¸ªà¸¢à¸­à¸‡ à¸ªà¸¸à¸”à¸›à¸¥à¸²à¸¢à¸—à¸²à¸‡à¸„à¸·à¸­à¸«à¹‰à¸­à¸‡à¸—à¸µà¹ˆà¸„à¸¸à¹‰à¸™à¹€à¸„à¸¢â€” à¸«à¹‰à¸­à¸‡à¸™à¸­à¸™à¸‚à¸­à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡, à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸™à¸±à¹‰à¸™à¸„à¸·à¸­à¸šà¸²à¸™à¸›à¸£à¸°à¸•à¸¹à¸«à¹‰à¸­à¸‡à¸‚à¸­à¸‡à¹€à¸˜à¸­à¸œà¸¹à¹‰à¸¡à¸µà¸¨à¸±à¸à¸”à¸´à¹Œà¹€à¸›à¹‡à¸™à¸žà¸µà¹ˆ à¸¡à¸·à¸­à¸£à¸µà¸šà¸¢à¸±à¸™à¸•à¸±à¸§à¹€à¸­à¸‡à¸‚à¸¶à¹‰à¸™ à¸„à¸²à¸”à¸«à¸§à¸±à¸‡à¹„à¸­à¸„à¸§à¸²à¸¡à¸­à¸šà¸­à¸¸à¹ˆà¸™à¸ˆà¸²à¸à¹€à¸˜à¸­à¸›à¸¥à¸­à¸šà¸›à¸£à¸°à¹‚à¸¥à¸¡à¹ƒà¸«à¹‰à¸„à¸§à¸²à¸¡à¸•à¸£à¸°à¸«à¸™à¸à¸ˆà¸²à¸‡à¸¥à¸‡à¹„à¸›",
//         background : "../picture/background_story/scare/scare_5.jpg",
//         next: "scare_6"
//     },

//     scare_6: {
//         text: "à¹„à¸«à¸¥à¹ˆà¸à¸£à¸°à¹à¸—à¸à¸›à¸£à¸°à¸•à¸¹à¸•à¹ˆà¸²à¸‡à¸à¸²à¸£à¹€à¸„à¸²à¸° à¸¡à¸·à¸­à¹€à¸­à¸·à¹‰à¸­à¸¡à¸«à¸¡à¸¸à¸™à¸¥à¸¹à¸à¸šà¸´à¸”à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸£à¹ˆà¸‡à¸£à¸µà¸šà¸à¸­à¸›à¸£à¸£à¸§à¸¡à¸à¸±à¸šà¸«à¸§à¸²à¸”à¸à¸¥à¸±à¸§ ... ",
//         background : "../picture/background_story/scare/scare_6.jpg",
//         next: "scare_7"
//     },

//     scare_7: {
//         text: "à¸¡à¸±à¸™à¸ªà¹ˆà¸‡à¹€à¸ªà¸µà¸¢à¸‡ â€˜ à¹à¸à¸£à¹Šà¸â€” â€™ à¸—à¸§à¹ˆà¸²à¸à¸¥à¸­à¸™à¸à¸¥à¸±à¸šà¸¥à¹‡à¸­à¸à¸ªà¸™à¸´à¸— à¹€à¸¡à¸·à¹ˆà¸­à¸«à¸¡à¸¸à¸™à¹à¸£à¸‡à¸‚à¸¶à¹‰à¸™à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡ à¸à¸¥à¹„à¸à¸”à¹‰à¸²à¸™à¹ƒà¸™à¸à¸¥à¸±à¸šà¸¢à¸´à¹ˆà¸‡à¹à¸™à¹ˆà¸™à¸à¸§à¹ˆà¸²à¹€à¸”à¸´à¸¡ à¸„à¸¥à¹‰à¸²à¸¢à¸¢à¸´à¹ˆà¸‡à¸žà¸¢à¸²à¸¢à¸²à¸¡à¸¡à¸²à¸à¹€à¸—à¹ˆà¸²à¹„à¸£ à¸¡à¸±à¸™à¸à¹‡à¸¢à¸´à¹ˆà¸‡à¸•à¹‰à¸²à¸™à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¹€à¸›à¸´à¸”à¸­à¸­à¸à¸¡à¸²à¸à¸‚à¸¶à¹‰à¸™à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ ...",
//         background : "../picture/background_story/scare/scare_7.jpg",
//         next: "scare_8"
//     },

//     scare_8: {
//         text: "à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¸«à¸±à¸™à¸¡à¸­à¸‡à¸¢à¸±à¸‡à¸ªà¸¸à¸”à¸ªà¸²à¸¢à¸•à¸² à¸à¸µà¹€à¸—à¹‰à¸²à¸à¹‰à¸²à¸§à¸¢à¸²à¸§à¸£à¸µà¸šà¸£à¹‰à¸­à¸™â€” à¸ˆà¸™à¸«à¸¢à¸¸à¸”à¸¢à¸·à¸™à¸«à¸™à¹‰à¸²à¸«à¹‰à¸­à¸‡à¸•à¸±à¸§à¹€à¸­à¸‡ à¹ƒà¸™à¸‚à¸“à¸°à¸—à¸µà¹ˆà¸à¹ˆà¸²à¸¡à¸·à¸­à¸à¸³à¸¥à¸±à¸‡à¹€à¸­à¸·à¹‰à¸­à¸¡à¹„à¸›à¸à¸­à¸šà¸à¸¸à¸¡à¸£à¸­à¸šà¸¥à¸¹à¸à¸šà¸´à¸” à¹€à¸ªà¸µà¸¢à¸‡à¸à¸¸à¸à¸à¸±à¸à¸”à¸±à¸‡à¸¥à¸­à¸”à¸œà¹ˆà¸²à¸™à¸—à¸³à¹ƒà¸«à¹‰à¸ˆà¸³à¸•à¹‰à¸­à¸‡à¸Šà¸°à¸‡à¸±à¸à¸„à¹‰à¸²à¸‡à¸à¸¥à¸²à¸‡à¸­à¸²à¸à¸²à¸¨",
//         background : "../picture/background_story/scare/scare_8.jpg",
//         next: "scare_9"
//     },

//     scare_9: {
//         text: "à¸–à¸¹à¸à¸šà¸µà¸šà¸ˆà¸™à¹„à¸¡à¹ˆà¹€à¸«à¸¥à¸·à¸­à¸—à¸²à¸‡à¹€à¸¥à¸·à¸­à¸à¹ƒà¸”â€” à¹€à¸«à¸¥à¸·à¸­à¸šà¸¡à¸­à¸‡à¸¥à¸‡à¹„à¸›à¸¢à¸±à¸‡à¸šà¸±à¸™à¹„à¸”à¸”à¹‰à¸²à¸™à¸‚à¹‰à¸²à¸‡ à¸„à¸§à¸²à¸¡à¸¥à¸±à¸‡à¹€à¸¥à¸žà¸²à¸”à¸œà¹ˆà¸²à¸™à¹€à¸žà¸µà¸¢à¸‡à¹€à¸ªà¸µà¹‰à¸¢à¸§à¸§à¸´à¸™à¸²à¸—à¸µ à¸à¹ˆà¸­à¸™à¸„à¸§à¸²à¸¡à¸à¸¥à¸±à¸§à¹€à¸‚à¹‰à¸²à¸à¸±à¸”à¸à¸´à¸™à¹à¸—à¸™à¸—à¸µà¹ˆ ...",
//         background : "../picture/background_story/scare/scare_9.jpg",
//         next: "scare_downstair_1"
//     },

//     scare_downstair_1: {
//         text: "à¸šà¸±à¸™à¹„à¸”à¸—à¸­à¸”à¸¢à¸²à¸§à¸¥à¸‡à¹„à¸›à¸ªà¸¹à¹ˆà¸Šà¸±à¹‰à¸™à¸¥à¹ˆà¸²à¸‡ à¸‚à¸²à¸à¹‰à¸²à¸§à¸¥à¸‡à¸—à¸µà¸¥à¸°à¸‚à¸±à¹‰à¸™ ... à¸—à¸µà¸¥à¸°à¸‚à¸±à¹‰à¸™ ... à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸Šà¸·à¹ˆà¸­à¸‡à¸Šà¹‰à¸² à¸”à¸±à¸‡à¸à¸¥à¸±à¸§à¸§à¹ˆà¸²à¸«à¸²à¸à¸ªà¹ˆà¸‡à¹€à¸ªà¸µà¸¢à¸‡à¸”à¸±à¸‡ à¸•à¹‰à¸™à¸•à¸­à¹€à¸ªà¸µà¸¢à¸‡à¸à¸¸à¸à¸à¸±à¸à¹ƒà¸™à¸«à¹‰à¸­à¸‡à¸™à¸±à¹‰à¸™à¸ˆà¸°à¸£à¸¹à¹‰à¸•à¸±à¸§à¸‚à¸¶à¹‰à¸™à¸¡à¸²â€” à¸šà¸£à¸£à¸¢à¸²à¸à¸²à¸¨à¸¡à¸·à¸”à¸¡à¸´à¸”à¹à¸œà¹ˆà¸•à¸±à¸§à¹‚à¸­à¸šà¸¥à¹‰à¸­à¸¡ à¸¢à¸²à¸¡à¹€à¸¡à¸·à¹ˆà¸­à¸ªà¸²à¸¢à¸•à¸²à¹€à¸«à¹‡à¸™à¹€à¸ªà¹‰à¸™à¸—à¸²à¸‡à¹€à¸›à¹‡à¸™à¹€à¸‡à¸²à¸ˆà¸²à¸‡ à¸¡à¸·à¸­à¸ˆà¸¶à¸‡à¸„à¸¥à¸³à¹€à¸žà¸·à¹ˆà¸­à¸«à¸²à¸—à¸²à¸‡à¸­à¸­à¸ ...",
//         background : "../picture/background_story/downstair.jpg",
//         next: "to_be_continue"
//     },

//     to_be_continue: {
//         text : "à¹‚à¸›à¸£à¸”à¸•à¸´à¸”à¸•à¸²à¸¡à¹ƒà¸™à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™à¸–à¸±à¸”à¹„à¸›...",
//         background : "",
//         next: ""
//     }
// }


function preloadAllImages(storyObj, callback) {
    const images = [];
    for (const key in storyObj) {
        const scene = storyObj[key];
        if (scene.background) images.push(scene.background);
        if (scene.characterleft) images.push(scene.characterleft);
        if (scene.characterright) images.push(scene.characterright);
    }

    const total = images.length;
    let loaded = 0;

    images.forEach(src => {
        const img = new Image();
        img.src = src;
        img.onload = img.onerror = () => {
            loaded++;
            const percent = Math.round((loaded / total) * 100);
            preloadBar.style.width = percent + "%";
            preloadPercent.textContent = percent + "%";

            if (loaded === total) {
                setTimeout(() => {
                    loadingScreen.style.display = "none";
                    callback();
                }, 500);
            }
        };
    });

    if (images.length === 0) {
        loadingScreen.style.display = "none";
        callback();
    }
}

function loadScene(scene, skipHistoryPush = false) {
    currentScene = scene;
    const sceneData = story[scene];
    storyText.textContent = "";

    mapBtn.style.display = "none";
    readbook_container.style.display = "none";
    readBtn.style.display = "none";
    pauseBtn.style.display = "none";
    textBox.style.display = "none";
    contiText.style.display = "none";
    characterBoxLeft.style.display = "none";
    characterBoxRight.style.display = "none";
    choiceBtn1.style.display = "none";
    choiceBtn2.style.display = "none";

    document.body.style.backgroundImage = `url(${sceneData.background})`;

    if (!skipHistoryPush) {
        // à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸ªà¸±à¹ˆà¸‡à¸‚à¹‰à¸²à¸¡ (à¹€à¸Šà¹ˆà¸™ à¹€à¸¥à¹ˆà¸™à¸›à¸à¸•à¸´) à¹ƒà¸«à¹‰à¹€à¸à¹‡à¸šà¸›à¸£à¸°à¸§à¸±à¸•à¸´
        sceneHistory.push(scene);
    }

    triggerAutoSave();

    if (sceneData.delay) {
        setTimeout(() => {
            if (sceneData.next) loadScene(sceneData.next);
        }, sceneData.delay);
        return;
    }

    if (sceneData.characterleft) {
        setTimeout(() => {
            characterBoxLeft.style.backgroundImage = `url(${sceneData.characterleft})`;
            characterBoxLeft.style.display = "flex";
        }, sceneData.delay || 500);
    }

    if (sceneData.characterright) {
        setTimeout(() => {
            characterBoxRight.style.backgroundImage = `url(${sceneData.characterright})`;
            characterBoxRight.style.display = "flex";
        }, sceneData.delay || 500);
    }

    if (sceneData.text) {
        setTimeout(() => {
            readBtn.style.display = "flex";
            pauseBtn.style.display = "flex";
            mapBtn.style.display = "flex";

            advanceLock = false;
            typeWriter(sceneData.text, () => {
                contiText.style.display = "flex";
            });
        }, sceneData.delay || 500);
    }

    if (sceneData.diarytext) {
        advanceLock = false;
        readbook_container.style.display = "flex";
        book_text.innerHTML = sceneData.diarytext.replace(/\n/g, "<br>").replace(/\\n/g, "<br>");
    }
}


function typeWriter(text, callback) {
    let i = 0;
    storyText.textContent = "";
    isTyping = true;
    hasFinishedTyping = false;
    textBox.style.display = "flex";
    let textSpeed = localStorage.getItem('textSpeed') || 5;
    let delayLetter = 60;
    if (textSpeed == 1) {
        delayLetter = 120;
    } else if (textSpeed == 2) {
        delayLetter = 60;
    } else if (textSpeed == 3) {
        delayLetter = 30;
    }

    typeInterval = setInterval(() => {
        if (text.charAt(i) === "\n") {
            storyText.innerHTML += "<br>";
        } else if (text.charAt(i) === '\\' && text.charAt(i + 1) === 'n') {
            storyText.innerHTML += "<br>";
            i++;
        } else {
            storyText.innerHTML += text.charAt(i);
        }
        i++;
        if (i >= text.length) {
            clearInterval(typeInterval);
            isTyping = false;
            if (!hasFinishedTyping) {
                allText.innerHTML += storyText.innerHTML.replace(/\n/g, "<br>") + "<br><br>";
                hasFinishedTyping = true;
            }
            callback?.();
        }
    }, delayLetter)
}

function fullText(text) {
    clearInterval(typeInterval);
    isTyping = false;

    storyText.innerHTML = text.replace(/\n/g, "<br>").replace(/\\n/g, "<br>");
    if (!hasFinishedTyping) {
        allText.innerHTML += text.replace(/\n/g, "<br>").replace(/\\n/g, "<br>") + "<br><br>";
        hasFinishedTyping = true;
    }
    contiText.style.display = "flex";
}

function choiceSetup(sceneData) {
    textBox.style.display = "none";
    contiText.style.display = "none";
    characterBoxLeft.style.display = "none";
    characterBoxRight.style.display = "none";

    if (sceneData.choice1) {
        choiceBtn1.style.display = "flex";
        choiceBtn1.innerHTML = sceneData.choice1;
        choiceBtn1.style.top = sceneData.choice_position_top1;
        choiceBtn1.style.left = sceneData.choice_position_left1;
        choiceBtn1.onclick = () => {
            if (advanceLock) return;
            advanceLock = true;
            loadScene(sceneData.choice1_next);
        };
    }
    if (sceneData.choice2) {
        choiceBtn2.style.display = "flex";
        choiceBtn2.innerHTML = sceneData.choice2;
        choiceBtn2.style.top = sceneData.choice_position_top2;
        choiceBtn2.style.left = sceneData.choice_position_left2;
        choiceBtn2.onclick = () => {
            if (advanceLock) return;
            advanceLock = true;
            loadScene(sceneData.choice2_next);
        };
    }
}

function proceedStory() {
    if (advanceLock || isTyping) return;
    const sceneData = story[currentScene];

    if (currentScene === "end") {
        window.location.href = "index.html";
        return;
    }

    if (sceneData.choice1 || sceneData.choice2) {
        choiceSetup(sceneData);
    } else if (sceneData.next) {
        advanceLock = true;
        loadScene(sceneData.next);
    }
}

/**
 * à¸ªà¸£à¹‰à¸²à¸‡à¹à¸¥à¸°à¹à¸ªà¸”à¸‡à¸œà¸¥ Flowchart
 * ðŸš€ [à¹à¸à¹‰à¹„à¸‚: à¹à¸ªà¸”à¸‡à¹€à¸‰à¸žà¸²à¸°à¸‰à¸²à¸à¸—à¸µà¹ˆà¹€à¸„à¸¢à¹€à¸¥à¹ˆà¸™à¸–à¸¶à¸‡ (Visited)]
 */
function generateFlowchart() {
    // à¹€à¸„à¸¥à¸µà¸¢à¸£à¹Œ Map à¹€à¸à¹ˆà¸²
    mapContainer.innerHTML = "";

    // 1. ðŸš€ (à¸ªà¸³à¸„à¸±à¸) à¹€à¸­à¸² 'knownScenes' à¹à¸¥à¸° 'for loop' à¸­à¸­à¸
    // à¹€à¸£à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹à¸„à¹ˆ Set à¸‚à¸­à¸‡à¸‰à¸²à¸à¸—à¸µà¹ˆà¹€à¸„à¸¢à¹„à¸›à¹à¸¥à¹‰à¸§
    const visitedScenes = new Set(sceneHistory);

    // 2. à¹ƒà¸Šà¹‰à¸­à¸±à¸¥à¸à¸­à¸£à¸´à¸—à¸¶à¸¡ BFS à¸ªà¸£à¹‰à¸²à¸‡ Map à¸—à¸µà¸¥à¸°à¹à¸–à¸§ (à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡)
    const allNodes = new Set();
    let queue = ["scene_1"];

    while (queue.length > 0) {
        const rowDiv = document.createElement("div");
        rowDiv.className = "flow-row";

        const nextQueue = [];
        let nextRowHasVisitedNodes = false; // ðŸ‘ˆ [à¹€à¸žà¸´à¹ˆà¸¡] à¹€à¸Šà¹‡à¸à¸§à¹ˆà¸²à¹à¸–à¸§à¸–à¸±à¸”à¹„à¸›à¸¡à¸µ Node à¸—à¸µà¹ˆà¹€à¸£à¸²à¹€à¸„à¸¢à¹„à¸›à¹„à¸«à¸¡

        // 3. à¸§à¸™à¸¥à¸¹à¸›à¸ªà¸£à¹‰à¸²à¸‡ Node à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹ƒà¸™à¹à¸–à¸§à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™
        for (const sceneId of queue) {
            if (allNodes.has(sceneId)) continue;

            const scene = story[sceneId];
            if (!scene) continue;

            allNodes.add(sceneId);

            // 4. à¸ªà¸£à¹‰à¸²à¸‡ Node
            const node = document.createElement("div");
            node.className = "flow-node";

            // ðŸš€ [à¹€à¸žà¸´à¹ˆà¸¡] à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸£à¸¹à¸›à¸ à¸²à¸ž (à¸ˆà¸²à¸à¹‚à¸„à¹‰à¸”à¸à¹ˆà¸­à¸™à¸«à¸™à¹‰à¸²)
            if (scene.background) {
                node.style.backgroundImage = `url(${scene.background})`;
            } else {
                node.textContent = sceneId;
                node.style.backgroundColor = "#111";
            }

            // 5. ðŸš€ [à¹à¸à¹‰à¹„à¸‚] à¸à¸³à¸«à¸™à¸”à¸ªà¸–à¸²à¸™à¸°
            if (visitedScenes.has(sceneId)) {
                node.classList.add("visited");
            } else {
                // à¸–à¹‰à¸²à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹€à¸„à¸¢à¹„à¸› à¹ƒà¸«à¹‰à¸‹à¹ˆà¸­à¸™à¹€à¸¥à¸¢
                node.classList.add("unknown"); // (CSS à¸ªà¸±à¹ˆà¸‡ display: none)
            }

            // ðŸš€ [à¸ªà¸³à¸„à¸±à¸] à¹€à¸£à¸²à¸•à¹‰à¸­à¸‡ appendChild 'à¸—à¸¸à¸' Node 
            // (à¹à¸¡à¹‰à¹à¸•à¹ˆ Node à¸—à¸µà¹ˆà¸‹à¹ˆà¸­à¸™à¸­à¸¢à¸¹à¹ˆ) à¹€à¸žà¸·à¹ˆà¸­à¸£à¸±à¸à¸©à¸² Layout à¸‚à¸­à¸‡ Flexbox
            rowDiv.appendChild(node);

            // 6. à¹€à¸žà¸´à¹ˆà¸¡à¸‰à¸²à¸à¸–à¸±à¸”à¹„à¸› (Next/Choices) à¸¥à¸‡à¹ƒà¸™à¸„à¸´à¸§ (à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡)
            if (scene.next && !allNodes.has(scene.next)) {
                nextQueue.push(scene.next);
                // ðŸš€ [à¹€à¸žà¸´à¹ˆà¸¡] à¹€à¸Šà¹‡à¸à¸§à¹ˆà¸²à¸‰à¸²à¸à¸–à¸±à¸”à¹„à¸›à¸—à¸µà¹ˆà¹€à¸£à¸²à¸ˆà¸°à¹„à¸›à¸•à¹ˆà¸­à¸™à¸±à¹‰à¸™ 'à¹€à¸„à¸¢à¹„à¸›' à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ
                if (visitedScenes.has(scene.next)) nextRowHasVisitedNodes = true;
            }
            if (scene.choice1_next && !allNodes.has(scene.choice1_next)) {
                nextQueue.push(scene.choice1_next);
                if (visitedScenes.has(scene.choice1_next)) nextRowHasVisitedNodes = true;
            }
            if (scene.choice2_next && !allNodes.has(scene.choice2_next)) {
                nextQueue.push(scene.choice2_next);
                if (visitedScenes.has(scene.choice2_next)) nextRowHasVisitedNodes = true;
            }
        }

        // 7. à¹€à¸žà¸´à¹ˆà¸¡à¹à¸–à¸§ (Row) à¸¥à¸‡à¹ƒà¸™ Map
        mapContainer.appendChild(rowDiv);

        // 8. ðŸš€ [à¹à¸à¹‰à¹„à¸‚] à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸ªà¹‰à¸™à¹€à¸Šà¸·à¹ˆà¸­à¸¡ (Line)
        // à¸•à¹ˆà¸­à¹€à¸¡à¸·à¹ˆà¸­ 'à¹à¸–à¸§à¸–à¸±à¸”à¹„à¸›' à¸¡à¸µ Node à¸—à¸µà¹ˆà¹€à¸£à¸² 'à¹€à¸„à¸¢à¹„à¸›' à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
        if (nextQueue.length > 0 && nextRowHasVisitedNodes) {
            const line = document.createElement("div");
            line.className = "flow-line";
            mapContainer.appendChild(line);
        }

        // 9. à¸­à¸±à¸›à¹€à¸”à¸•à¸„à¸´à¸§ (à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡)
        queue = [...new Set(nextQueue)];
    }
}

function preloadNextImages(currentScene, count = 5) {
    const keys = Object.keys(story);
    const index = keys.indexOf(currentScene);

    if (index === -1) return;

    const nextKeys = keys.slice(index + 1, index + 1 + count);

    nextKeys.forEach(key => {
        const scene = story[key];
        if (scene.background) {
            const img = new Image();
            img.src = scene.background;
        }
        if (scene.characterleft) {
            const img = new Image();
            img.src = scene.characterleft;
        }
        if (scene.characterright) {
            const img = new Image();
            img.src = scene.characterright;
        }
    });
}

// ðŸš€ à¹€à¸žà¸´à¹ˆà¸¡: à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹à¸¥à¸°à¹‚à¸«à¸¥à¸”à¹€à¸‹à¸Ÿ (à¸ˆà¸²à¸ Homepage)
function checkAndLoadSave() {
    const saveDataString = localStorage.getItem('selected_save');

    if (saveDataString) {
        try {
            const save = JSON.parse(saveDataString);

            // 1. ðŸš€ à¸à¸¹à¹‰à¸„à¸·à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸³à¸„à¸±à¸
            activeSaveSlot = save; // ðŸ‘ˆ à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸‹à¸Ÿà¹„à¸§à¹‰ (à¸ªà¸³à¸„à¸±à¸à¸¡à¸²à¸)
            sceneHistory = JSON.parse(save.scene_history);
            gameVariables = JSON.parse(save.variables || "{}");

            // 2. à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸‰à¸²à¸à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ (à¸‰à¸²à¸à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢à¹ƒà¸™à¸›à¸£à¸°à¸§à¸±à¸•à¸´)
            currentScene = sceneHistory[sceneHistory.length - 1];

            // 3. à¸¥à¸šà¹„à¸Ÿà¸¥à¹Œà¹€à¸‹à¸Ÿà¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§à¸—à¸´à¹‰à¸‡
            localStorage.removeItem('selected_save');

            console.log("âœ… Save file loaded:", activeSaveSlot.id);
            return true; // à¹‚à¸«à¸¥à¸”à¸ªà¸³à¹€à¸£à¹‡à¸ˆ

        } catch (err) {
            console.error("âŒ Failed to parse save file:", err);
            localStorage.removeItem('selected_save');
            return false;
        }
    }
    // à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¹€à¸ˆà¸­ 'selected_save' (à¹€à¸Šà¹ˆà¸™ à¹„à¸¡à¹ˆà¹„à¸”à¹‰ login à¸«à¸£à¸·à¸­à¹à¸„à¹ˆà¸à¸” Start)
    // à¹ƒà¸«à¹‰à¹€à¸£à¸´à¹ˆà¸¡à¹€à¸à¸¡à¹ƒà¸«à¸¡à¹ˆà¸›à¸à¸•à¸´
    sceneHistory = ["scene_1"]; // ðŸ‘ˆ à¹€à¸£à¸´à¹ˆà¸¡à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¹ƒà¸«à¸¡à¹ˆ
    currentScene = "scene_1";
    return false; // à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¹‚à¸«à¸¥à¸”
}

function triggerAutoSave() {
    // à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸¡à¸µà¹€à¸‹à¸Ÿà¸—à¸µà¹ˆà¸à¸³à¸¥à¸±à¸‡à¹€à¸¥à¹ˆà¸™à¸­à¸¢à¸¹à¹ˆ (à¹€à¸Šà¹ˆà¸™ à¹„à¸¡à¹ˆà¹„à¸”à¹‰ login) à¸à¹‡à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸—à¸³à¸­à¸°à¹„à¸£
    if (!activeSaveSlot) {
        return;
    }

    // à¸¥à¹‰à¸²à¸‡ timer à¹€à¸à¹ˆà¸² (à¸–à¹‰à¸²à¸¡à¸µ)
    if (autoSaveTimer) {
        clearTimeout(autoSaveTimer);
    }

    // à¸•à¸±à¹‰à¸‡à¹€à¸§à¸¥à¸²à¹ƒà¸«à¸¡à¹ˆ: à¹ƒà¸«à¹‰à¸£à¸­ 2 à¸§à¸´à¸™à¸²à¸—à¸µà¸«à¸¥à¸±à¸‡à¸ˆà¸²à¸à¸‰à¸²à¸à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ à¸„à¹ˆà¸­à¸¢à¹€à¸‹à¸Ÿ
    autoSaveTimer = setTimeout(autoSaveGame, 2000);
}

// ðŸš€ à¹€à¸žà¸´à¹ˆà¸¡: à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ Auto-save (à¸•à¸±à¸§à¸ˆà¸£à¸´à¸‡)
async function autoSaveGame() {
    if (!activeSaveSlot) return; // à¸¢à¸·à¸™à¸¢à¸±à¸™à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡

    console.log("Auto-saving game...");

    // à¸£à¸§à¸šà¸£à¸§à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™
    const saveData = {
        current_scene: currentScene,
        scene_history: JSON.stringify(sceneHistory),
        variables: JSON.stringify(gameVariables)
        // à¹€à¸£à¸²à¸ˆà¸°à¸ªà¹ˆà¸‡ 3 à¸­à¸¢à¹ˆà¸²à¸‡à¸™à¸µà¹‰à¹„à¸›à¹ƒà¸«à¹‰ API
    };

    try {
        const res = await fetch(`${API_URL}/saves/${activeSaveSlot.id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(saveData)
        });

        const data = await res.json();
        if (data.success) {
            console.log("âœ… Auto-save successful.");
        } else {
            console.warn("Auto-save failed:", data.error);
        }
    } catch (err) {
        console.error("Auto-save connection error:", err);
    }
}

readbook_container.addEventListener("click", () => {
    if (advanceLock) return;
    readbook_container.style.display = "none";
    proceedStory();
});

textBox.addEventListener("click", () => {
    if (advanceLock) return;
    if (isTyping) {
        fullText(story[currentScene].text);
    } else {
        proceedStory();
    }
});

document.addEventListener("keydown", (e) => {
    if (e.code === "Space") {
        e.preventDefault();
        if (advanceLock) return;
        if (isTyping) {
            fullText(story[currentScene].text);
        } else {
            proceedStory();
        }
    }
});

readBtn.addEventListener("click", () => {
    background.style.display = "flex";
    allTextBox.style.display = "flex";
});

exitTextBtn.addEventListener("click", () => {
    background.style.display = "none";
    allTextBox.style.display = "none";
});

background.addEventListener("click", () => {
    background.style.display = "none";
    allTextBox.style.display = "none";
});

pauseBtn.addEventListener("click", () => {
    background.style.display = "flex";
    pauseMenu.style.display = "flex";
});

mapBtn.addEventListener("click", () => {

});

resumeBtn.addEventListener("click", () => {
    background.style.display = "none";
    pauseMenu.style.display = "none";
});

restartBtn.addEventListener("click", () => {
    window.location.reload();
});

mainBtn.addEventListener("click", () => {
    window.location.href = "../index.html";
});

mapBtn.addEventListener("click", () => {
    // à¸ªà¸£à¹‰à¸²à¸‡ Map à¹ƒà¸«à¸¡à¹ˆà¸—à¸¸à¸à¸„à¸£à¸±à¹‰à¸‡
    generateFlowchart();
    // à¹à¸ªà¸”à¸‡ Map
    mapFrame.style.display = "block";
});

// à¹€à¸žà¸´à¹ˆà¸¡à¸›à¸¸à¹ˆà¸¡à¸›à¸´à¸” Map
closeMapBtn.addEventListener("click", () => {
    mapFrame.style.display = "none";
});

window.addEventListener("load", async () => {
    const saveLoaded = checkAndLoadSave();
    await loadStoryFromBackend();
    preloadAllImages(story, () => {
        loadScene(currentScene, saveLoaded);
    });
});